<Schema name="CDS" description="HIV Collaborative Dataspace">


    <Dimension visible="true" highCardinality="false" name="Antigen">
        <Hierarchy visible="true" hasAll="true" primaryKey="id" name="Clade">
            <Table schema="cds" name="antigens">
            </Table>
            <Level name="Clade" visible="true" column="clade" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
            </Level>
            <Level name="Name" visible="true" column="id" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
                <Property name="Country Of Origin" column="countryoforigin" type="String" dependsOnLevelValue="true"/>
            </Level>
        </Hierarchy>
        <Hierarchy visible="true" hasAll="true" primaryKey="id" name="Tier">
            <Table schema="cds" name="antigens" >
            </Table>
            <Level name="Tier" visible="true" column="tier" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
            </Level>
            <Level name="Name" visible="true" column="id" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
                <Property name="Country Of Origin" column="countryoforigin" type="String" dependsOnLevelValue="true"/>
            </Level>
        </Hierarchy>
        <Hierarchy visible="true" hasAll="true" primaryKey="id" name="Sample Type">
            <Table schema="cds" name="antigens">
            </Table>
            <Level name="Sample Type" visible="true" column="specimensource" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
            </Level>
            <Level name="Name" visible="true" column="id" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
                <Property name="Country Of Origin" column="countryoforigin" type="String" dependsOnLevelValue="true"/>
            </Level>
        </Hierarchy>
    </Dimension>


    <Dimension visible="true" highCardinality="false" name="Assay">
        <Hierarchy visible="true" hasAll="true" primaryKey="name" name="Target Area">
            <Table schema="study" name="StudyDesignAssays" />
            <Level name="Target Area" visible="true" column="target" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" />
            <Level name="Name" visible="true" column="name" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
            </Level>
        </Hierarchy>
        <Hierarchy visible="true" hasAll="true" primaryKey="name" name="Methodology">
            <Table schema="study" name="StudyDesignAssays" />
            <Level name="Methodology" visible="true" column="methodology" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never" />
            <Level name="Name" visible="true" column="label" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
            </Level>
        </Hierarchy>
    </Dimension>



    <Cube name="DataspaceCube" visible="true" defaultMeasure="ParticipantCount" cache="true" enabled="true">

        <Annotations>
            <Annotation name="SchemaName">Study</Annotation>
        </Annotations>

        <Table schema="cds" name="facts" >
        </Table>


        <Dimension visible="true" highCardinality="false" name="Subject" foreignKey="participantid">
            <Hierarchy visible="true" hasAll="true" primaryKey="subjectid">
                <Table name="demographics" schema="study"/>
                <Level name="Container" visible="true" column="Folder" levelType="Regular" hideMemberIf="Never"/>
                <Level name="Subject" visible="true" column="SubjectID" type="String" uniqueMembers="false" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
            <Hierarchy name="Race" visible="true" hasAll="true" primaryKey="subjectid">
                <Table name="demographics" schema="study"/>
                <Level name="Race" visible="true" column="race" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
            <Hierarchy name="Country" visible="true" hasAll="true" primaryKey="subjectid">
                <Table name="demographics" schema="study"/>
                <Level name="Country" visible="true" column="country" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
            <Hierarchy name="Sex" visible="true" hasAll="true" primaryKey="subjectid">
                <Table name="demographics" schema="study"/>
                <Level name="Sex" visible="true" column="sex" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
            <Hierarchy name="Ethnicity" visible="true" hasAll="true" primaryKey="subjectid">
                <Table name="demographics" schema="study"/>
                <Level name="Ethnicity" visible="true" column="ethnicity" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
            <Hierarchy name="Gender" visible="true" hasAll="true" primaryKey="subjectid">
                <Table name="demographics" schema="study"/>
                <Level name="Gender" visible="true" column="gender" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
        </Dimension>

        <Dimension visible="true" highCardinality="false" name="Vaccine" foreignKey="participantid">
            <Hierarchy name="Type" hasAll="true" primaryKey="subjectid" primaryKeyTable="ParticipantTreatments">
                <Join leftKey="treatmentid" rightKey="treatmentid">
                    <Table name="ParticipantTreatments" schema="study"/>
                    <Join leftKey="productid" rightKey="rowid">
                        <Table name="TreatmentProductMap" schema="study"/>
                        <Table name="Product" schema="study"/>
                    </Join>
                </Join>
                <Level name="Type" table="Product" visible="true" column="type" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
                <Level name="Name" table="Product" visible="true" column="label" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never"/>
            </Hierarchy>
        </Dimension>

        <DimensionUsage source="Antigen" name="Antigen" visible="true" foreignKey="antigen" highCardinality="false">
        </DimensionUsage>


        <DimensionUsage source="Assay" name="Assay" visible="true" foreignKey="assay" highCardinality="false">
        </DimensionUsage>

        <Dimension visible="true" highCardinality="false" name="Lab" foreignKey="lab">
            <Hierarchy visible="true" hasAll="true">
                <Table schema="study" name="StudyDesignLabs" />
                <Level name="Lab" visible="true" column="Name" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="Never">
                </Level>
            </Hierarchy>
        </Dimension>

        <Dimension visible="true" highCardinality="false" name="Study" foreignKey="study">
            <Hierarchy visible="true" hasAll="true" primaryKey="container">
                <Table schema="study" name="StudyProperties" />
                <Level name="Study" visible="true" column="label" type="String" uniqueMembers="true" levelType="Regular" hideMemberIf="IfBlankName">
                </Level>
            </Hierarchy>
        </Dimension>


        <Measure name="ParticipantCount" column="participantid" aggregator="distinct-count" visible="true">
        </Measure>


        <Measure name="RowCount" column="participantid" aggregator="count" visible="true">
        </Measure>
    </Cube>

</Schema>
